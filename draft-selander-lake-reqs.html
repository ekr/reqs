<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Requirements for a Lightweight AKE for OSCORE</title>

  
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">


  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Problem description">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Credentials">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Identity Protection">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Crypto Agility">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 AKE for OSCORE">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Lightweight">
<link href="#rfc.section.3" rel="Chapter" title="3 Requirements Summary">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="6 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.34.0 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Vucinic, M., Selander, G., and J. Mattsson" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-selander-lake-reqs-latest" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-10-31" />
  <meta name="dct.abstract" content="This document compiles the requirements for a lightweight authenticated key exchange protocol for OSCORE." />
  <meta name="description" content="This document compiles the requirements for a lightweight authenticated key exchange protocol for OSCORE." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">M. Vucinic</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">INRIA</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">G. Selander</td>
</tr>
<tr>
<td class="left">Expires: May 3, 2020</td>
<td class="right">J. Mattsson</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Ericsson AB</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Requirements for a Lightweight AKE for OSCORE<br />
  <span class="filename">draft-selander-lake-reqs-latest</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document compiles the requirements for a lightweight authenticated key exchange protocol for OSCORE.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 3, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Problem description</a>
</li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Credentials</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Identity Protection</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Crypto Agility</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">AKE for OSCORE</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Lightweight</a>
</li>
</ul><li>3.   <a href="#rfc.section.3">Requirements Summary</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.references">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">OSCORE <a href="#RFC8613" class="xref">[RFC8613]</a> is a lightweight communication security protocol providing end-to-end security on application layer for constrained IoT settings (cf. <a href="#RFC7228" class="xref">[RFC7228]</a>). OSCORE lacks a matching authenticated key exchange protocol (AKE).</p>
<p id="rfc.section.1.p.2">To ensure that the AKE is efficient for the expected applications of OSCORE, we list the relevant public specifications of technologies where OSCORE is included:</p>
<p></p>

<ul>
<li>The IETF 6TiSCH WG charter (-02) identifies the need to &#8220;secur[e] the join process and mak[e] that fit within the constraints of high latency, low throughput and small frame sizes that characterize IEEE802.15.4 TSCH&#8221;. OSCORE protects the join protocol as described in 6TiSCH Minimal Security <a href="#I-D.ietf-6tisch-minimal-security" class="xref">[I-D.ietf-6tisch-minimal-security]</a>.</li>
<li>The IETF LPWAN WG charter (-01) identifies the need to improve the transport capabilities of LPWA networks such as NB-IoT and LoRa whose &#8220;common traits include &#8230; frame sizes &#8230; [on] the order of tens of bytes transmitted a few times per day at ultra-low speeds&#8221;. The application of OSCORE is described in <a href="#I-D.ietf-lpwan-coap-static-context-hc" class="xref">[I-D.ietf-lpwan-coap-static-context-hc]</a>.</li>
<li>OMA Specworks LwM2M version 1.1 <a href="#LwM2M" class="xref">[LwM2M]</a> defines bindings to two challenging radio technologies where OSCORE will be deployed: LoRaWAN and NB-IoT.</li>
</ul>
<p id="rfc.section.1.p.4">Other industry fora which plan to use OSCORE:</p>
<p></p>

<ul>
<li>Fairhair Alliance has defined an architecture <a href="#Fairhair" class="xref">[Fairhair]</a> which adopts OSCORE for multicast, but it is not clear whether the architecture will support unicast OSCORE.</li>
<li>Open Connectivity Foundation (OCF) has been actively involved in the OSCORE development for the purpose of deploying OSCORE, but no public reference is available since OCF only references RFCs. We believe that these OSCORE consumers reflect similar levels of constraints on the devices and networks in question.</li>
</ul>
<p id="rfc.section.1.p.6">This document compiles the requirements for the AKE for OSCORE.  It summarizes the security requirements that are expected from such an AKE, as well as the main characteristics of the environments where the solution is envisioned to be deployed.  The solution will presumably be useful in other scenarios as well since a low security overhead improves the overall performance.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#prob-desc" id="prob-desc">Problem description</a>
</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> <a href="#credentials" id="credentials">Credentials</a>
</h1>
<p id="rfc.section.2.1.p.1">IoT deployments differ in terms of what credentials can be supported. Currently many systems use pre-shared keys (PSK) provisioned out of band, for various reasons. PSK are often used in a first deployment because of its perceived simplicity. The use of PSK allows for protection of communication without major additional security processing, and also enables the use of symmetric crypto algorithms only, reducing the implementation and computational effort in the endpoints.</p>
<p id="rfc.section.2.1.p.2">However, PSK-based provisioning has inherent weaknesses. There has been reports of massive breaches of PSK provisioning systems, and as many systems use PSK without perfect forward secrecy (PFS) they are vulnerable to passive pervasive monitoring. The security of these systems can be improved by adding PFS through an AKE authenticated by the provisioned PSK.</p>
<p id="rfc.section.2.1.p.3">Shared keys can alternatively be established in the endpoints using an AKE protocol authenticated with asymmetric public keys instead of symmetric secret keys. Raw public keys (RPK) can be provisioned with the same scheme as PSKs, which allows a more relaxed trust model since RPKs need not be secret.</p>
<p id="rfc.section.2.1.p.4">As a third option, by running the same asymmetric key AKE with public key certificates instead of RPK, key provisioning can be omitted, leading to a more automated bootstrapping procedure.</p>
<p id="rfc.section.2.1.p.5">These steps provide an example of a migration path in limited scoped steps from simple to more robust security bootstrapping and provisioning schemes where each step improves the overall security and/or simplicity of deployment of the IoT system, although not all steps are necessarily feasible for the most constrained settings.</p>
<p id="rfc.section.2.1.p.6">In order to allow for these different schemes, the AKE must support PSK, RPK and certificate-based authentication.</p>
<p id="rfc.section.2.1.p.7">Bandwidth is a scarce resource in constrained-node networks.  To minimize the bandwidth consumption it is therefore desirable to support transporting the certificates by reference rather than by value.  Considering the wide variety of deployments the AKE must support different schemes for transporting and identifying credentials, see Section 2 of <a href="#I-D.ietf-cose-x509" class="xref">[I-D.ietf-cose-x509]</a>.</p>
<p id="rfc.section.2.1.p.8">The common lack of a user interface in constrained devices leads to various credential provisioning schemes.  The use of RPKs may be appropriate for the authentication of the AKE initiator but not for the AKE responder.  The AKE must support different credentials for authentication in different directions of the AKE run, e.g. certificate-based authentication for the initiating endpoint and RPK-based authentication for the responding endpoint.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> <a href="#identity-protection" id="identity-protection">Identity Protection</a>
</h1>
<p id="rfc.section.2.2.p.1">Transporting identities as part of the AKE run is a necessity in order to provide strong mutual authentication.  In the case of constrained devices, the identity may contain sensitive information on the manufacturer of the device, the batch, default firmware version&#8230; Protecting the identities from passive and active attacks is important from the privacy point of view.  The AKE is required to support identity protection of one of the peers in the AKE run in the case of public key identities, or the protection of the PSK identifier in the case of PSK-based authentication.</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> <a href="#crypto-agility" id="crypto-agility">Crypto Agility</a>
</h1>
<p id="rfc.section.2.3.p.1">Motivated by long deployment lifetimes, the AKE is required to support crypto agility, including modularity of COSE crypto algorithms and negotiation of preferred crypto algorithms for OSCORE and the AKE. The AKE negotiation must be protected against downgrade attacks.</p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> <a href="#AKE-OSCORE" id="AKE-OSCORE">AKE for OSCORE</a>
</h1>
<p id="rfc.section.2.4.p.1">In order to be suitable for OSCORE, at the end of the AKE protocol run the two parties must agree on (see Section 3.2 of <a href="#RFC8613" class="xref">[RFC8613]</a>):</p>
<p></p>

<ul>
<li>a shared secret (OSCORE Master Secret) with PFS and a good amount of randomness. (The term &#8220;good amount of randomness&#8221; is borrowed from <a href="#HKDF" class="xref">[HKDF]</a> to signify not necessarily uniformly distributed randomness.)</li>
<li>identifiers providing a hint to the receiver of what security context to use when decrypting the message (OSCORE Sender IDs of peer endpoints), arbitrarily short</li>
<li>COSE algorithms to use with OSCORE</li>
</ul>
<p id="rfc.section.2.4.p.3">Moreover, the AKE must support the same transport as OSCORE, in particular any protocol where CoAP can be transported.</p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> <a href="#lw" id="lw">Lightweight</a>
</h1>
<p id="rfc.section.2.5.p.1">As motivated in <a href="#AKE-OSCORE" class="xref">Section 2.4</a> we target an AKE which is efficiently deployable in 6TiSCH multi-hop networks, LoRaWAN networks and NB-IoT networks. The desire is to optimize the AKE to be &#8216;as lightweight as reasonably achievable&#8217; in these environments, where &#8216;lightweight&#8217; refers to:</p>
<p></p>

<ul>
<li>resource consumption, measured by bytes on the wire, wall-clock time and number of round trips to complete, or power consumption</li>
<li>the amount of new code required on end systems which already have an OSCORE stack</li>
</ul>
<p id="rfc.section.2.5.p.3">These properties need to be considered in the context of the use of an existing CoAP/OSCORE stack in the targeted networks. However, some properties may be difficult to evaluate for a given protocol, for example, because they depend on the radio conditions or other simultaneous network traffic. Therefore these properties should be taken as input for identifying plausible protocol metrics that can be more easily measured and compared between protocols.</p>
<p id="rfc.section.2.5.p.4">Per &#8216;bytes on the wire&#8217;, it is desirable for these AKE messages to fit into the MTU size of these protocols; and if not possible, within as few frames as possible, since using multiple MTUs can have significant costs in terms of time and power.</p>
<p id="rfc.section.2.5.p.5">Per &#8216;time&#8217;, it is desirable for the AKE message exchange(s) to complete in a reasonable amount of time, both for a single uncongested exchange and when multiple exchanges are running in an interleaved fashion, like e.g. in a &#8220;network formation&#8221; setting when multiple devices connect for the first time. This latency may not be a linear function depending on congestion and the specific radio technology used. As these are relatively low data rate networks, the latency contribution due to computation is in general not expected to be dominant.</p>
<p id="rfc.section.2.5.p.6">Per &#8216;round-trips&#8217;, it is desirable that the number of completed request/response message exchanges required before the initiating endpoint can start sending protected traffic data is as small as possible, since this reduces completion time. See <a href="#disc" class="xref">Section 2.5.4</a> for a discussion about the tradeoff between message size and number of messages.</p>
<p id="rfc.section.2.5.p.7">Per &#8216;power&#8217;, it is desirable for the transmission of AKE messages and crypto to draw as little power as possible. The best mechanism for doing so differs across radio technologies.  For example, NB-IoT uses licensed spectrum and thus can transmit at higher power to improve coverage, making the transmitted byte count relatively more important than for other radio technologies.  In other cases, the radio transmitter will be active for a full MTU frame regardless of how much of the frame is occupied by message content, which makes the byte count less sensitive for the power consumption.  Increased power consumption is unavoidable in poor network conditions, such as most wide-area settings including LoRaWAN.</p>
<p id="rfc.section.2.5.p.8">Per &#8216;new code&#8217;, it is desirable to introduce as little new code as possible onto OSCORE-enabled devices to support this new AKE. These devices have on the order of 10s of kB of memory and 100 kB of storage on which an embedded OS; a COAP stack; CORE and AKE libraries; and target applications would run. It is expected that the majority of this space is available for actual application logic, as opposed to the support libraries. In a typical OSCORE implementation COSE encrypt and signature structures will be available, as will support for COSE algorithms relevant for IoT enabling the same algorithms as is used for OSCORE (e.g. COSE algorithm no. 10 = CCM* used by 6TiSCH). The use of those, or CBOR or CoAP, would not add to the footprint.</p>
<p id="rfc.section.2.5.p.9">While the large variety of settings and capabilities of the devices and networks makes it challenging to produce exact values of some these dimensions, there are some key benchmarks that are tractable for security protocol engineering and which have a significant impact.</p>
<h1 id="rfc.section.2.5.1">
<a href="#rfc.section.2.5.1">2.5.1.</a> <a href="#lorawan" id="lorawan">LoRaWAN</a>
</h1>
<p id="rfc.section.2.5.1.p.1">LoRaWAN employs unlicensed radio frequency bands in the 868MHz ISM band, in Europe regulated by ETSI EN 300 220. For LoRaWAN the most relevant metric is the Time-on-Air, which determines the back-off times and can be used an indicator to calculate energy consumption. LoRaWAN is legally required to use a 1% (or smaller) duty cycle, a payload split into two fragments instead of one increases the time to complete the sending of this payload by at least 10,000%. The use of an AKE for providing end-to-end security on application layer need to comply with the duty cycle. One relevant benchmark is performance in low coverage with Data Rates 0-2 corresponding to a packet size of 51 bytes <a href="#LoRaWAN" class="xref">[LoRaWAN]</a>. While larger frame sizes are also defined, their use depend on good radio conditions. Some libraries/providers only support 51 bytes packet size.</p>
<h1 id="rfc.section.2.5.2">
<a href="#rfc.section.2.5.2">2.5.2.</a> <a href="#tisch" id="tisch">6TiSCH</a>
</h1>
<p id="rfc.section.2.5.2.p.1">6TiSCH operates in the 2.4 GHz unlicensed frequency band and uses hybrid Time Division/Frequency Division multiple access (TDMA/FDMA).  Nodes in a 6TiSCH network form a mesh.  The basic unit of communication, a cell, is uniquely defined by its time and frequency offset in the communication schedule matrix.  Cells can be assigned for communication to a pair of nodes in the mesh and so be collision-free, or shared by multiple nodes, for example during network formation.  In case of shared cells, some collision-resolution scheme such as slotted-Aloha is employed.  Nodes exchange frames which are at most 127-bytes long, including the link-layer headers.  To preserve energy, the schedule is typically computed in such a way that nodes switch on their radio below 1% of the time (&#8220;radio duty cycle&#8221;).  A 6TiSCH mesh can be several hops deep.  In typical use cases considered by the 6TiSCH working group, a network that is 2-4 hops deep is commonplace; a network which is more than 8 hops deep is not common.</p>
<h1 id="rfc.section.2.5.2.1">
<a href="#rfc.section.2.5.2.1">2.5.2.1.</a> <a href="#bytes-on-the-wire" id="bytes-on-the-wire">Bytes on the wire</a>
</h1>
<p id="rfc.section.2.5.2.1.p.1">Increasing the number of bytes on the wire in a protocol message has an important effect on the 6TiSCH network in case the fragmentation is triggered.  More fragments contribute to congestion of shared cells (and concomitant error rates) in a non-linear way.</p>
<p id="rfc.section.2.5.2.1.p.2">The available size for key exchange messages depends on the topology of the network, whether the message is traveling uplink or downlink, and other stack parameters.  A key performance indicator for a 6TiSCH network is &#8220;network formation&#8221;, i.e. the time it takes from switching on all devices, until the last device has executed the AKE and securely joined.  As an example, given the size limit on the frames and taking into account the different headers (including link-layer security), if a 6TiSCH network is 5 hops deep, the maximum CoAP payload size to avoid fragmentation is 47/45 bytes (uplink/downlink) <a href="#AKE-for-6TiSCH" class="xref">[AKE-for-6TiSCH]</a>.</p>
<h1 id="rfc.section.2.5.2.2">
<a href="#rfc.section.2.5.2.2">2.5.2.2.</a> <a href="#time" id="time">Time</a>
</h1>
<p id="rfc.section.2.5.2.2.p.1">Given the slotted nature of 6TiSCH, the number of bytes in a frame has insignificant impact on latency, but the number of frames has.  The relevant metric for studying AKE is the network formation time, which implies parallel AKE runs among nodes that are attempting to join the network.  Network formation time directly affects the time installers need to spend on site at deployment time.</p>
<h1 id="rfc.section.2.5.2.3">
<a href="#rfc.section.2.5.2.3">2.5.2.3.</a> <a href="#round-trips-and-number-of-messages" id="round-trips-and-number-of-messages">Round trips and number of messages</a>
</h1>
<p id="rfc.section.2.5.2.3.p.1">Given the mesh nature of the 6TiSCH network, and given that each message may travel several hops before reaching its destination, it is highly desirable to minimize the number of round trips to reduce latency.</p>
<h1 id="rfc.section.2.5.2.4">
<a href="#rfc.section.2.5.2.4">2.5.2.4.</a> <a href="#power" id="power">Power</a>
</h1>
<p id="rfc.section.2.5.2.4.p.1">From the power consumption point of view, it is more favorable to send a small number of large frames than a larger number of short frames.</p>
<h1 id="rfc.section.2.5.3">
<a href="#rfc.section.2.5.3">2.5.3.</a> <a href="#nb-iot" id="nb-iot">NB-IoT</a>
</h1>
<p id="rfc.section.2.5.3.p.1">For NB-IoT, in contrast to the other two technologies below, the radio bearers are not characterized by a fixed sized PDU. Concatenation, segmentation and reassembly are part of the service provided by the radio layer. Furthermore, since NB-IoT is operating in licensed spectrum, the packets on the radio interface can be transmitted back-to-back, so the time before sending OSCORE protected data is dependent on the number of round trips/messages of the AKE. An AKE providing challenge-response based mutual authentication requires at least three messages/one round trip before it is possible to encrypt traffic data between peers meeting for the first time. NB-IoT has a high per byte energy consumption component for uplink transfers, implying that those messages should be as small as possible.</p>
<h1 id="rfc.section.2.5.4">
<a href="#rfc.section.2.5.4">2.5.4.</a> <a href="#disc" id="disc">Discussion</a>
</h1>
<p id="rfc.section.2.5.4.p.1">While &#8220;as small protocol messages as possible&#8221; does not lend itself to a sharp boundary threshold, &#8220;as few protocol messages as possible&#8221; does and is relevant in all settings above.</p>
<p id="rfc.section.2.5.4.p.2">The penalty is high for not fitting into the frame sizes of 6TiSCH and LoRaWAN networks. Fragmentation is not defined within these technologies so requires fragmentation scheme on a higher layer in the stack. With fragmentation increases the number of frames per message, each with its associated overhead in terms of power consumption and latency. Additionally the probability for errors increases, which leads to retransmissions of frames or entire messages that in turn increases the power consumption and latency.</p>
<p id="rfc.section.2.5.4.p.3">There are trade-offs between &#8220;few messages&#8221; and &#8220;few frames&#8221;; if overhead is spread out over more messages such that each message fits into a particular frame this may reduce the overall power consumption. While it may be possible to engineer such a solution for a particular radio technology and signature algorithm, the benefits in terms of fewer messages/round trips in general and for NB-IoT in particular (see <a href="#nb-iot" class="xref">Section 2.5.3</a>) are considered more important than optimizing for a specific scenario. Hence an optimal AKE protocol has 3 messages and each message fits into as few frames as possible, ideally 1 frame per message.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#requirements-summary" id="requirements-summary">Requirements Summary</a>
</h1>
<p></p>

<ul>
<li>The AKE must support PSK, RPK and certificate based authentication and crypto agility, be 3-pass and support the same transport as OSCORE. It is desirable to support different schemes for transporting and identifying credentials.</li>
<li>After the AKE run, the peers must be mutually authenticated, agree on a shared secret with PFS and good amount of randomness, peer identifiers (potentially short), and COSE algorithms to use.</li>
<li>The AKE must reuse CBOR, CoAP and COSE primitives and algorithms for low code complexity of a combined OSCORE and AKE implementation.</li>
<li>The messages must be as small as reasonably achievable and fit into as few LoRaWAN packets and 6TiSCH frames as possible, optimally 1 for each message.</li>
</ul>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#sec-cons" id="sec-cons">Security Considerations</a>
</h1>
<p id="rfc.section.4.p.1">This document compiles the requirements for an AKE and provides some related security considerations.</p>
<p id="rfc.section.4.p.2">The AKE must provide the security properties expected of IETF protocols, e.g., providing confidentiality protection, integrity protection, and authentication with strong work factor.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">None.</p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="AKE-for-6TiSCH">[AKE-for-6TiSCH]</b></td>
<td class="top">"<a href="https://docs.google.com/document/d/1wLoIexMLG3U9iYO5hzGzKjkvi-VDndQBbYRNsMUlh-k">AKE for 6TiSCH</a>", March 2019.</td>
</tr>
<tr>
<td class="reference"><b id="Fairhair">[Fairhair]</b></td>
<td class="top">"<a href="https://www.fairhair-alliance.org/data/downloadables/1/9/fairhair_security_wp_march-2018.pdf">Security Architecture for the Internet of Things (IoT) in Commercial Buildings, Fairhair Alliance white paper</a>", March 2018.</td>
</tr>
<tr>
<td class="reference"><b id="HKDF">[HKDF]</b></td>
<td class="top">
<a>Krawczyk, H.</a>, "<a href="https://eprint.iacr.org/2010/264.pdf">Cryptographic Extraction and Key Derivation: The HKDF Scheme</a>", May 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-6tisch-minimal-security">[I-D.ietf-6tisch-minimal-security]</b></td>
<td class="top">
<a>Vucinic, M.</a>, <a>Simon, J.</a>, <a>Pister, K.</a> and <a>M. Richardson</a>, "<a href="https://tools.ietf.org/html/draft-ietf-6tisch-minimal-security-13">Minimal Security Framework for 6TiSCH</a>", Internet-Draft draft-ietf-6tisch-minimal-security-13, October 2019.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-cose-x509">[I-D.ietf-cose-x509]</b></td>
<td class="top">
<a>Schaad, J.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-cose-x509-04">CBOR Object Signing and Encryption (COSE): Headers for carrying and referencing X.509 certificates</a>", Internet-Draft draft-ietf-cose-x509-04, September 2019.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-lpwan-coap-static-context-hc">[I-D.ietf-lpwan-coap-static-context-hc]</b></td>
<td class="top">
<a>Minaburo, A.</a>, <a>Toutain, L.</a> and <a>R. Andreasen</a>, "<a href="https://tools.ietf.org/html/draft-ietf-lpwan-coap-static-context-hc-11">LPWAN Static Context Header Compression (SCHC) for CoAP</a>", Internet-Draft draft-ietf-lpwan-coap-static-context-hc-11, October 2019.</td>
</tr>
<tr>
<td class="reference"><b id="LoRaWAN">[LoRaWAN]</b></td>
<td class="top">"<a href="https://lora-alliance.org/resource-hub/lorawantm-regional-parameters-v102rb">LoRaWAN Regional Parameters v1.0.2rB</a>", February 2017.</td>
</tr>
<tr>
<td class="reference"><b id="LwM2M">[LwM2M]</b></td>
<td class="top">"<a href="http://www.openmobilealliance.org/release/LightweightM2M/V1_1-20180710-A/OMA-TS-LightweightM2M_Transport-V1_1-20180710-A.pdf">OMA SpecWorks LwM2M</a>", August 2018.</td>
</tr>
<tr>
<td class="reference"><b id="RFC7228">[RFC7228]</b></td>
<td class="top">
<a>Bormann, C.</a>, <a>Ersue, M.</a> and <a>A. Keranen</a>, "<a href="https://tools.ietf.org/html/rfc7228">Terminology for Constrained-Node Networks</a>", RFC 7228, DOI 10.17487/RFC7228, May 2014.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8613">[RFC8613]</b></td>
<td class="top">
<a>Selander, G.</a>, <a>Mattsson, J.</a>, <a>Palombini, F.</a> and <a>L. Seitz</a>, "<a href="https://tools.ietf.org/html/rfc8613">Object Security for Constrained RESTful Environments (OSCORE)</a>", RFC 8613, DOI 10.17487/RFC8613, July 2019.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Malisa Vucinic</span> 
	  <span class="n hidden">
		<span class="family-name">Vucinic</span>
	  </span>
	</span>
	<span class="org vcardline">INRIA</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:malisa.vucinic@inria.fr">malisa.vucinic@inria.fr</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">G&#246;ran Selander</span> 
	  <span class="n hidden">
		<span class="family-name">Selander</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson AB</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:goran.selander@ericsson.com">goran.selander@ericsson.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Mattsson</span> 
	  <span class="n hidden">
		<span class="family-name">Mattsson</span>
	  </span>
	</span>
	<span class="org vcardline">Ericsson AB</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:john.mattsson@ericsson.com">john.mattsson@ericsson.com</a></span>

  </address>
</div>

</body>
</html>

